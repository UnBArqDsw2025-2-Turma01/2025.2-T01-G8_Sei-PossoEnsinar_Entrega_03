# 3.3.1. Command

## Introdução

Este documento detalha a aplicação do padrão de projeto Command (Comando) – um dos padrões Comportamentais do Gang of Four (GoF) – no sistema de gerenciamento de sessões de ensino. O objetivo central do padrão Command é **encapsular uma chamada de método como um objeto**. Essa técnica converte solicitações ou operações em objetos autocontidos, permitindo que as requisições sejam manipuladas de maneira flexível, suportando funcionalidades avançadas como a organização de filas de tarefas, o registro de histórico de ações (log) e a implementação de operações de desfazer (undo).

No contexto deste projeto, o padrão Command é implementado para formalizar e desacoplar as interações do Aluno com os serviços do sistema. Ao encapsular ações como "Buscar Monitor" ou "Acessar Material" em objetos de comando, o painel de controle do Aluno pode gerenciar e executar essas requisições de forma uniforme, sem a necessidade de conhecer a lógica de negócio subjacente.

-----

## Metodologia

A implementação do padrão Command foi realizada seguindo as melhores práticas de design orientado a objetos:

1. Mapeamento de Ações: Análise das interações primárias do Aluno com o sistema para identificar ações que poderiam ser tratadas de forma assíncrona ou enfileirada. As ações `buscarMonitor` e `acessarMateriais` foram escolhidas como Comandos Concretos.
2. Estrutura de Componentes: Definição dos quatro papéis essenciais do padrão:
    * **Command:** Interface `AcaoAluno`
    * **Concrete Command:** Classes `BuscarMonitorCommand` e `AcessarMaterialCommand`
    * **Receiver:** Classe `ServicoAluno`
    * **Invoker:** Classe `PainelAluno`
3. Desenvolvimento em Java: Implementação da interface `AcaoAluno` com o método `executar()`, garantindo que cada comando armazene o `Receiver` (`ServicoAluno`) e os parâmetros necessários.

-----

## Desenvolvimento

O padrão Command foi aplicado para desacoplar a requisição da ação. A classe `Aluno` (Cliente) agora não executa a lógica de negócio diretamente, mas sim cria objetos de comando e os entrega ao `PainelAluno` (Invoker) para que sejam executados posteriormente.

### Componentes e Fluxo

| Componente           | Elemento no Código     | Função no Fluxo                                                                                                                                               |
| :------------------- | :--------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Receiver**         | `ServicoAluno`         | Contém a lógica real de negócio (ex: buscar no banco de dados, carregar material). O objeto de comando referencia o Receiver.                                 |
| **Command**          | `AcaoAluno`            | Define o método `executar()` para todos os comandos.                                                                                                          |
| **Concrete Command** | `BuscarMonitorCommand` | Encapsula o `ServicoAluno` (Receiver) e os parâmetros (`topico`), chamando `servico.buscarMonitor(...)` no método `executar()`.                               |
| **Invoker**          | `PainelAluno`          | Mantém uma fila (`List<AcaoAluno>`) de comandos. O método `executarAcoes()` percorre a fila e chama `comando.executar()`. Não tem conhecimento do `Receiver`. |
| **Client**           | `Aluno`                | Cria os comandos e define a fila de execução, garantindo a parametrização das ações.                                                                          |

-----

### Diagrama

<font size="2"><p style="text-align: center"><b>Figura 1:</b> Diagrama de Classes do padrão Command</p></font>

<div style="text-align: center;">

![proxy](../images/DiagramaCommand.png)

</div>

<font size="2"><p style="text-align: center"><b>Autor:</b> <a href="https://github.com/leanars">Bruno Cruz e Anne de Capdeville</a>, 2025</p></font>


-----
### Código

O código demonstra como o `Aluno` parametriza o `PainelAluno` (Invoker) e, em seguida, o `Invoker` executa a fila de requisições de forma uniforme e sequencial.

#### AcaoAluno

```
public interface AcaoAluno {
    void executar();
}

```
#### ServicoAluno

```
public class ServicoAluno {

    public void buscarMonitor(int alunoId, String habilidade) {
        System.out.println("   [RECEIVER: ServicoAluno] Aluno ID " + alunoId + ": Iniciando busca por Monitor...");
        System.out.println("   [RECEIVER: ServicoAluno] Busca concluida para habilidade: " + habilidade);
    }

    public void acessarMaterial(int alunoId, int idMaterial) {
        System.out.println("   [RECEIVER: ServicoAluno] Aluno ID " + alunoId + ": Verificando permissao e acessando Material ID " + idMaterial);
        System.out.println("   [RECEIVER: ServicoAluno] Material ID " + idMaterial + " acessado com sucesso.");
    }
}

```

#### Aluno

```
public class Aluno {
    
    private final int idAluno;

    public Aluno(int idAluno) {
        this.idAluno = idAluno;
    }

    public void acessarMateriais(PainelAluno painel, ServicoAluno servico, int idMaterial) {
        AcaoAluno comando = new AcessarMaterialComando(this, servico, idMaterial);
        painel.adicionarComando(comando);
    }

    public void buscarMonitor(PainelAluno painel, ServicoAluno servico, String habilidade) {
        AcaoAluno comando = new BuscarMonitorComando(this, servico, habilidade);
        painel.adicionarComando(comando);
    }

    public int getIdAluno() {
        return idAluno;
    }
}

```

#### BuscarMonitorComando

```
public class BuscarMonitorComando implements AcaoAluno {

    private final Aluno aluno;
    private final ServicoAluno servico; // O Receiver
    private final String habilidade;

    public BuscarMonitorComando(Aluno aluno, ServicoAluno servico, String habilidade) {
        this.aluno = aluno;
        this.servico = servico;
        this.habilidade = habilidade;
    }

    @Override
    public void executar() {
        System.out.println("\n[COMANDO: BuscarMonitor] Encapsulando e disparando a busca por: " + habilidade);
        servico.buscarMonitor(aluno.getIdAluno(), habilidade);
    }
}

```

#### AcessarMaterialComando

```
public class AcessarMaterialComando implements AcaoAluno {
    
    private final Aluno aluno;
    private final ServicoAluno servico; // O Receiver
    private final int idMaterial;
    
    public AcessarMaterialComando(Aluno aluno, ServicoAluno servico, int idMaterial) {
        this.aluno = aluno;
        this.servico = servico;
        this.idMaterial = idMaterial;
    }

    @Override
    public void executar() {
        System.out.println("\n[COMANDO: AcessarMaterial] Encapsulando e disparando acesso ao Material ID: " + idMaterial);
        servico.acessarMaterial(aluno.getIdAluno(), idMaterial);
    }
}
```

#### PainelAluno

```
import java.util.ArrayList;
import java.util.List;

public class PainelAluno {
    
    private final List<AcaoAluno> listaComandos = new ArrayList<>();

    public void adicionarComando(AcaoAluno comando) {
        System.out.println("[INVOKER: PainelAluno] Comando adicionado a fila.");
        listaComandos.add(comando);
    }
    
    public void executarAcoes() {
        System.out.println("\n*** INVOKER INICIANDO EXECUCAO DE AÇOES PENDENTES ***");
        for (AcaoAluno comando : listaComandos) {
            comando.executar(); 
        }
        System.out.println("*** FILA DE EXECUCAO CONCLUIDA ***");
        listaComandos.clear();
    }
}

```

#### Aplicacao (Main)

```
public class Aplicacao {

    public static void main(String[] args) {
        System.out.println("==============================================");
        System.out.println("--- DEMONSTRACAO DO COMMAND (GOF) ---");
        System.out.println("==============================================");

        ServicoAluno servico = new ServicoAluno();

        PainelAluno painel = new PainelAluno();

        Aluno aluno = new Aluno(1001);

        System.out.println("\n--- ALUNO PARAMETRIZANDO ACOES ---");
        
        aluno.buscarMonitor(painel, servico, "Java");
        aluno.acessarMateriais(painel, servico, 45); 
        aluno.buscarMonitor(painel, servico, "Proxy/Bridge"); 
        
        // Invoker executa a fila de comandos.
        painel.executarAcoes();

        System.out.println("\n--- FIM ---");
        System.out.println("O Invoker executou acoes variadas de forma desacoplada do Aluno e do ServicoAluno.");
    }
}

```

-----

## Vídeo de Execução

* [Execução do Código]()

* [Repositório do Código](https://github.com/UnBArqDsw2025-2-Turma01/2025.2-T01-G8_Sei-PossoEnsinar_Entrega_03/tree/code-command)

-----

## Conclusão

A implementação do padrão Command no módulo de interação do Aluno traz ganhos significativos em modularidade e flexibilidade. O princípio de encapsular uma requisição como um objeto (AcaoAluno) permite que o sistema desacople o ator da ação (o Aluno do ServicoAluno). Isso confere ao PainelAluno (Invoker) a capacidade de manipular as requisições, suportando funcionalidades avançadas, como a implementação futura de filas de comandos, agendamento de tarefas assíncronas, ou o histórico de ações para suporte à operação de undo e redo. O Command, como padrão Comportamental, cumpre seu papel de organizar e formalizar as interações.

-----

## Bibliografia

> **GAMMA, Erich et al.** Design Patterns: Elements of Reusable Object-Oriented Software. Addison-Wesley, 1995 
> 
> **MILENE SERRANO.** Arquitetura e Desenho de Software - Aula GoFs Estruturais. Material didático, Universidade de Brasília (UnB), 2025
> 
> **LARMAN, Craig.** Utilizando UML e Padrões: Uma Introdução a Análise e ao Projeto Orientado a Objetos. 3ª ed. Bookman, 2007
  
-----

## Histórico de Versões

| Versão | Data       | Descrição                          | Autor(es)                       | Revisor(es)        |
| :----- | :--------- | :--------------------------------- | :------------------------------ | :----------------- |
| 1.0    | 24/10/2025 | Criação da documentação            | Anne de Capdeville              | Bruno Cruz         |
| 1.1    | 24/10/2025 | Documentação e criação do diagrama | Anne de Capdeville e Bruno Cruz | Bruno Cruz         |
| 1.2    | 24/10/2025 | Adição dos códigos                 | Anne de Capdeville e Bruno Cruz | Anne de Capdeville |
| 1.3    | 24/10/2025 | Adição da conclusão e bibliografia | Anne de Capdeville e Bruno Cruz | Anne de Capdeville |
